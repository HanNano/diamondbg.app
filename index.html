<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>One2World Directory</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 400px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 20px;
            padding: 20px 0;
        }
        
        .header h1 {
            font-size: 22px;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            opacity: 0.9;
            font-size: 13px;
            line-height: 1.4;
        }
        
        .search-box {
            background: white;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 15px;
        }
        
        .search-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .search-btn {
            width: 100%;
            padding: 10px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            margin-bottom: 8px;
        }
        
        .add-host-btn {
            width: 100%;
            padding: 10px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            margin-bottom: 5px;
        }
        
        .reload-btn {
            width: 100%;
            padding: 8px;
            background: #ffc107;
            color: black;
            border: none;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
        }
        
        .host-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 15px;
            display: none;
        }
        
        .host-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .host-avatar {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 15px;
            border: 3px solid #667eea;
        }
        
        .host-info {
            flex: 1;
        }
        
        .host-name {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        .host-bigo-id {
            color: #ff6b6b;
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .social-links {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        
        .social-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 20px;
            text-decoration: none;
            color: white;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: transform 0.2s;
            cursor: pointer;
        }
        
        .social-btn:hover {
            transform: translateY(-1px);
        }
        
        .social-btn.facebook { background: #1877f2; }
        .social-btn.instagram { background: #e4405f; }
        .social-btn.tiktok { background: #000000; }
        .social-btn.telegram { background: #0088cc; }
        .social-btn.youtube { background: #ff0000; }
        
        .no-result {
            background: white;
            padding: 25px 15px;
            border-radius: 15px;
            text-align: center;
            color: #666;
            display: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .sample-hosts {
            background: rgba(255,255,255,0.9);
            padding: 12px;
            border-radius: 12px;
            margin-bottom: 12px;
        }
        
        .sample-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #333;
            text-align: center;
            font-size: 13px;
        }
        
        .sample-list {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            justify-content: center;
        }
        
        .sample-bigo-id {
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .sample-bigo-id:hover {
            background: #5a6fd8;
        }
        
        .add-host-form {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 15px;
            display: none;
        }
        
        .form-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
            color: #333;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
        }
        
        .form-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .file-input {
            width: 100%;
            padding: 10px;
            border: 2px dashed #e0e0e0;
            border-radius: 8px;
            background: #f8f9fa;
            cursor: pointer;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .file-input:hover {
            background: #e9ecef;
        }
        
        .preview-container {
            text-align: center;
            margin: 10px 0;
        }
        
        .avatar-preview {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #667eea;
            display: none;
        }
        
        .remove-photo {
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            font-size: 12px;
            cursor: pointer;
            margin-top: 5px;
        }
        
        .form-buttons {
            display: flex;
            gap: 10px;
        }
        
        .submit-btn {
            flex: 1;
            padding: 10px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
        }
        
        .cancel-btn {
            flex: 1;
            padding: 10px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
        }
        
        .loading {
            text-align: center;
            padding: 10px;
            color: white;
            display: none;
        }
        
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
            display: none;
        }

        .instructions {
            background: rgba(255,255,255,0.9);
            padding: 12px;
            border-radius: 12px;
            margin-bottom: 12px;
            font-size: 11px;
            line-height: 1.4;
        }

        .instructions-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>One2World Directory</h1>
            <p>BIGO ID, Facebook, Instagram, TikTok á€á€…á€ºá€á€¯á€á€¯á€€á€­á€¯ á€›á€­á€¯á€€á€ºá€•á€¼á€®á€¸ á€›á€¾á€¬á€œá€­á€¯á€€á€ºá€šá€¯á€¶á€”á€²á€· á€á€„á€·á€ºá€›á€²á€· Celi á€á€…á€ºá€šá€±á€¬á€€á€ºá€€á€­á€¯á€•á€¼á€”á€ºá€á€½á€±á€·á€”á€­á€¯á€„á€ºá€•á€«á€•á€¼á€®</p>
        </div>
        
        <div class="instructions">
            <div class="instructions-title">ğŸ“ á€™á€¾á€á€ºá€á€»á€€á€ºá€™á€»á€¬á€¸:</div>
            <div>â€¢ TikTok: username á€á€¬á€‘á€Šá€·á€ºá€•á€«á€›á€¾á€„á€·á€º (á€¥á€•á€™á€¬: username)</div>
            <div>â€¢ Facebook: username á€•á€«á€•á€²á€›á€¾á€„á€·á€º</div>
            <div>â€¢ Instagram: username á€•á€²á€›á€¾á€„á€·á€º</div>
            <div>â€¢ Profile Picture: á€€á€­á€¯á€šá€ºá€•á€­á€¯á€„á€ºá€“á€¬á€á€ºá€•á€¯á€¶ á€á€„á€ºá€”á€­á€¯á€„á€ºá€•á€«á€á€šá€º</div>
        </div>
        
        <div class="sample-hosts">
            <div class="sample-title">ğŸ’¡ á€”á€™á€°á€”á€¬ ID á€™á€»á€¬á€¸ - á€”á€¾á€­á€•á€ºá€•á€¼á€®á€¸á€¡á€…á€™á€ºá€¸á€›á€¾á€¬á€€á€¼á€Šá€·á€ºá€•á€«:</div>
            <div class="sample-list">
                <div class="sample-bigo-id" onclick="searchSample('sweet_mm_22')">sweet_mm_22</div>
                <div class="sample-bigo-id" onclick="searchSample('game_king')">game_king</div>
                <div class="sample-bigo-id" onclick="searchSample('dance_queen')">dance_queen</div>
            </div>
        </div>
        
        <div class="search-box">
            <input type="text" class="search-input" id="searchInput" 
                   placeholder="BIGO ID, Facebook, Instagram, TikTok á€€á€­á€¯á€›á€­á€¯á€€á€ºá€€á€¼á€Šá€·á€ºá€•á€«...">
            <button class="search-btn" onclick="searchHost()">
                ğŸ” á€›á€¾á€¬á€™á€šá€º
            </button>
            <button class="add-host-btn" onclick="showAddHostForm()">
                â• á€¡á€á€…á€ºá€‘á€Šá€·á€ºá€™á€šá€º
            </button>
            <button class="reload-btn" onclick="reloadData()">
                ğŸ”„ Reload Data
            </button>
        </div>

        <div class="success-message" id="successMessage">
            âœ… á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸ á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€œá€­á€¯á€€á€ºá€•á€«á€•á€¼á€®á€›á€¾á€„á€·á€ºá‹
        </div>
        
        <div class="add-host-form" id="addHostForm">
            <div class="form-title">á€¡á€á€…á€ºá€‘á€Šá€·á€ºá€›á€”á€º</div>
            <div class="form-group">
                <label class="form-label" for="newHostName">Name *</label>
                <input type="text" class="form-input" id="newHostName" placeholder="Your Name" required>
            </div>
            <div class="form-group">
                <label class="form-label" for="newHostBigoId">BIGO ID *</label>
                <input type="text" class="form-input" id="newHostBigoId" placeholder="123456" required>
            </div>

            <!-- Profile Picture Upload Section -->
            <div class="form-group">
                <label class="form-label">Profile Picture</label>
                <input type="file" id="avatarUpload" accept="image/*" class="file-input" 
                       onchange="previewImage(this)">
                <div class="preview-container">
                    <img id="avatarPreview" class="avatar-preview" alt="Preview">
                    <button type="button" class="remove-photo" onclick="removePhoto()" style="display: none;">
                        âŒ á€“á€¬á€á€ºá€•á€¯á€¶ á€–á€»á€€á€ºá€™á€šá€º
                    </button>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label" for="newHostFacebook">Facebook</label>
                <input type="text" class="form-input" id="newHostFacebook" placeholder="username (facebook.com/username)">
            </div>
            <div class="form-group">
                <label class="form-label" for="newHostInstagram">Instagram</label>
                <input type="text" class="form-input" id="newHostInstagram" placeholder="username (username)">
            </div>
            <div class="form-group">
                <label class="form-label" for="newHostTiktok">TikTok</label>
                <input type="text" class="form-input" id="newHostTiktok" placeholder="username (@username)">
            </div>
            <div class="form-group">
                <label class="form-label" for="newHostTelegram">Telegram</label>
                <input type="text" class="form-input" id="newHostTelegram" placeholder="username (t.me/username)">
            </div>
            <div class="form-group">
                <label class="form-label" for="newHostYoutube">YouTube</label>
                <input type="text" class="form-input" id="newHostYoutube" placeholder="channel (youtube.com/channel)">
            </div>
            <div class="form-buttons">
                <button class="cancel-btn" onclick="hideAddHostForm()">á€™á€‘á€Šá€·á€ºá€á€±á€¬á€·á€•á€«</button>
                <button class="submit-btn" onclick="submitNewHost()">á€¡á€á€Šá€ºá€•á€¼á€¯á€•á€¼á€®á€¸á€•á€­á€¯á€·á€™á€šá€º</button>
            </div>
        </div>
        
        <div class="host-card" id="hostResult">
            <div class="host-header">
                <img src="" alt="Profile" class="host-avatar" id="hostAvatar">
                <div class="host-info">
                    <div class="host-name" id="hostName">Host Name</div>
                    <div class="host-bigo-id">ğŸ†” BIGO ID: <span id="hostBigoId">bigo_id</span></div>
                </div>
            </div>
            
            <div class="social-links" id="socialLinks">
            </div>
        </div>
        
        <div class="no-result" id="noResult">
            <div style="font-size: 40px; margin-bottom: 8px;">ğŸ˜”</div>
            <strong>á€›á€¾á€¬á€œá€­á€¯á€·á€™á€á€½á€±á€·á€•á€«</strong><br>
            <span style="font-size: 12px;">á€”á€™á€°á€”á€¬ ID á€™á€»á€¬á€¸á€€á€­á€¯á€…á€™á€ºá€¸á€›á€¾á€¬á€€á€¼á€Šá€·á€ºá€€á€¼á€Šá€·á€ºá€•á€«</span>
            <div style="margin-top: 10px;">
                <button class="add-host-btn" onclick="showAddHostForm()" style="font-size: 12px; padding: 6px 12px;">
                    â• á€’á€®á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€€á€­á€¯ á€á€­á€™á€ºá€¸á€™á€šá€ºá‹
                </button>
            </div>
        </div>
        
        <div class="loading" id="loading">
            ğŸ”„ á€›á€¾á€¬á€–á€½á€±á€”á€±á€•á€«á€á€Šá€º...
        </div>
    </div>

    <script>
        // ==================== CONFIGURATION ====================
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby7UTzoLqbAhPc01yHue_q6rWlrObEUZBaR4ZYszzsyWqex1GvvASYNTk7omPEB920N/exec';
        
        // ==================== VARIABLES ====================
        let tg = window.Telegram.WebApp;
        let hosts = {};
        let uploadedAvatar = null;

        // Sample data
        const sampleHosts = {
            'sweet_mm_22': {
                name: 'Hla Hla',
                bigoId: 'sweet_mm_22',
                facebook: 'sweet.hlahla',
                instagram: 'sweet_hla',
                tiktok: 'sweet_singer',
                telegram: 'hlahla',
                youtube: 'hlahla_music',
                avatar: 'https://cdn.pixabay.com/photo/2023/08/11/04/41/woman-8182795_960_720.jpg'
            },
            'game_king': {
                name: 'Min Ko',
                bigoId: 'game_king',
                facebook: 'minko.gamer',
                instagram: 'minko_games',
                tiktok: 'minko_gaming',
                telegram: 'minko',
                youtube: 'minko_gaming',
                avatar: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face'
            },
            'dance_queen': {
                name: 'Su Su',
                bigoId: 'dance_queen',
                facebook: 'susu.dancer',
                instagram: 'susu_dancer',
                tiktok: 'susu_dance',
                telegram: 'susu',
                youtube: 'susu_dance',
                avatar: 'https://cdn.pixabay.com/photo/2024/05/11/13/41/portrait-8754980_960_720.png'
            }
        };

        // ==================== IMAGE UPLOAD FUNCTIONS ====================
        function previewImage(input) {
            const preview = document.getElementById('avatarPreview');
            const removeBtn = document.querySelector('.remove-photo');
            
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                    removeBtn.style.display = 'block';
                    uploadedAvatar = e.target.result; // Store base64 image
                }
                
                reader.readAsDataURL(input.files[0]);
            }
        }

        function removePhoto() {
            const preview = document.getElementById('avatarPreview');
            const fileInput = document.getElementById('avatarUpload');
            const removeBtn = document.querySelector('.remove-photo');
            
            preview.style.display = 'none';
            removeBtn.style.display = 'none';
            fileInput.value = '';
            uploadedAvatar = null;
        }

        // ==================== SOCIAL BUTTONS FUNCTIONS ====================
        function createSocialButtons(host) {
            const socialLinks = document.getElementById('socialLinks');
            socialLinks.innerHTML = '';
            
            if (host.facebook && host.facebook !== 'none') {
                createSocialButton('facebook', 'https://facebook.com/' + host.facebook, 'ğŸ“˜ Facebook', socialLinks);
            }
            
            if (host.instagram && host.instagram !== 'none') {
                createSocialButton('instagram', 'https://instagram.com/' + host.instagram, 'ğŸ“· Instagram', socialLinks);
            }
            
            if (host.tiktok && host.tiktok !== 'none') {
                createSocialButton('tiktok', 'https://www.tiktok.com/@' + host.tiktok, 'ğŸµ TikTok', socialLinks);
            }
            
            if (host.telegram && host.telegram !== 'none') {
                createSocialButton('telegram', 'https://t.me/' + host.telegram, 'âœˆï¸ Telegram', socialLinks);
            }
            
            if (host.youtube && host.youtube !== 'none') {
                createSocialButton('youtube', 'https://youtube.com/@' + host.youtube, 'ğŸ“º YouTube', socialLinks);
            }
            
            if (socialLinks.children.length === 0) {
                const noSocialMsg = document.createElement('div');
                noSocialMsg.textContent = 'Social media accounts á€™á€›á€¾á€­á€á€±á€¸á€•á€«';
                noSocialMsg.style.color = '#666';
                noSocialMsg.style.fontSize = '12px';
                noSocialMsg.style.textAlign = 'center';
                noSocialMsg.style.padding = '10px';
                socialLinks.appendChild(noSocialMsg);
            }
        }

        function createSocialButton(platform, url, text, container) {
            const button = document.createElement('a');
            button.className = `social-btn ${platform}`;
            button.href = url;
            button.target = '_blank';
            button.innerHTML = text;
            container.appendChild(button);
        }

        // ==================== MAIN FUNCTIONS ====================
        function initTelegram() {
            if (typeof tg !== 'undefined') {
                tg.expand();
                tg.ready();
            }
            loadHostsFromGoogleSheets();
        }

        async function loadHostsFromGoogleSheets() {
            try {
                showLoading('á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸ á€á€±á€«á€ºá€šá€°á€”á€±á€•á€«á€á€Šá€º...');
                const response = await fetch(SCRIPT_URL + '?action=getData');
                const result = await response.json();
                
                if (result.status === 'success') {
                    hosts = {};
                    result.data.forEach(item => {
                        if (item.BIGO_ID) {
                            hosts[item.BIGO_ID] = {
                                name: item.Name || '',
                                bigoId: item.BIGO_ID,
                                facebook: item.Facebook || 'none',
                                instagram: item.Instagram || 'none',
                                tiktok: item.TikTok || 'none',
                                telegram: item.Telegram || 'none',
                                youtube: item.YouTube || 'none',
                                avatar: item.Avatar || getDefaultAvatar()
                            };
                        }
                    });
                    console.log('Reload Data');
                } else {
                    hosts = sampleHosts;
                    console.log('Sample data á€á€¯á€¶á€¸á€‘á€¬á€¸á€•á€«á€á€šá€º');
                }
            } catch (error) {
                hosts = sampleHosts;
                console.log('Sample data á€á€¯á€¶á€¸á€‘á€¬á€¸á€•á€«á€á€šá€º');
            } finally {
                hideLoading();
            }
        }

        function getDefaultAvatar() {
            // Simple default avatar
            return 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQijOJQ5CclwFsmT4FdxqPiUQWcfk4ozyHp2ccC1EQIQbORR-yihdYTyZqXGXbx0Tai9Gs&usqp=CAU';
        }

        async function reloadData() {
            try {
                showLoading('á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸ á€•á€¼á€”á€ºá€œá€Šá€ºá€á€±á€«á€ºá€šá€°á€”á€±á€•á€«á€á€Šá€º...');
                const response = await fetch(SCRIPT_URL + '?action=getData');
                const result = await response.json();
                
                if (result.status === 'success') {
                    hosts = {};
                    result.data.forEach(item => {
                        if (item.BIGO_ID) {
                            hosts[item.BIGO_ID] = {
                                name: item.Name || '',
                                bigoId: item.BIGO_ID,
                                facebook: item.Facebook || 'none',
                                instagram: item.Instagram || 'none',
                                tiktok: item.TikTok || 'none',
                                telegram: item.Telegram || 'none',
                                youtube: item.YouTube || 'none',
                                avatar: item.Avatar || getDefaultAvatar()
                            };
                        }
                    });
                    console.log('Reloaded data from Google Sheets:', Object.keys(hosts));
                    alert('âœ… á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸ á€•á€¼á€”á€ºá€œá€Šá€ºá€á€±á€«á€ºá€šá€°á€•á€¼á€®á€¸á€•á€«á€•á€¼á€®á‹\ná€…á€¯á€…á€¯á€•á€±á€«á€„á€ºá€¸: ' + Object.keys(hosts).length + ' á€šá€±á€¬á€€á€º');
                }
            } catch (error) {
                console.error('Reload error:', error);
                alert('âŒ á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸ á€á€±á€«á€ºá€šá€°á€›á€¬á€á€½á€„á€º á€¡á€™á€¾á€¬á€¸á€á€…á€ºá€á€¯á€–á€¼á€…á€ºá€”á€±á€•á€«á€á€Šá€º');
            } finally {
                hideLoading();
            }
        }

        function searchSample(bigoId) {
            document.getElementById('searchInput').value = bigoId;
            searchHost();
        }

        function searchHost() {
            const searchTerm = document.getElementById('searchInput').value.trim().toLowerCase();
            const hostResult = document.getElementById('hostResult');
            const noResult = document.getElementById('noResult');
            
            hostResult.style.display = 'none';
            noResult.style.display = 'none';
            hideAddHostForm();
            hideSuccessMessage();
            
            if (!searchTerm) {
                noResult.style.display = 'block';
                noResult.innerHTML = '<div style="font-size: 40px; margin-bottom: 8px;">ğŸ”</div><strong>ID á€‘á€Šá€·á€ºá€•á€±á€¸á€•á€«</strong><br><span style="font-size: 12px;">á€”á€™á€°á€”á€¬ ID á€™á€»á€¬á€¸á€€á€­á€¯á€”á€¾á€­á€•á€ºá€•á€¼á€®á€¸ á€…á€™á€ºá€¸á€€á€¼á€Šá€·á€ºá€•á€«</span>';
                return;
            }
            
            let foundHost = null;
            const cleanSearchTerm = searchTerm.replace('@', '');
            
            for (const [id, host] of Object.entries(hosts)) {
                if (id.toLowerCase() === cleanSearchTerm ||
                    id.toLowerCase().includes(cleanSearchTerm) ||
                    host.name.toLowerCase().includes(cleanSearchTerm) ||
                    (host.facebook !== 'none' && host.facebook.toLowerCase().includes(cleanSearchTerm)) ||
                    (host.instagram !== 'none' && host.instagram.toLowerCase().includes(cleanSearchTerm)) ||
                    (host.tiktok !== 'none' && host.tiktok.toLowerCase().includes(cleanSearchTerm)) ||
                    (host.telegram !== 'none' && host.telegram.toLowerCase().includes(cleanSearchTerm)) ||
                    (host.youtube !== 'none' && host.youtube.toLowerCase().includes(cleanSearchTerm))) {
                    foundHost = host;
                    console.log('Found host:', foundHost);
                    break;
                }
            }
            
            if (foundHost) {
                document.getElementById('hostName').textContent = foundHost.name;
                document.getElementById('hostBigoId').textContent = foundHost.bigoId;
                document.getElementById('hostAvatar').src = foundHost.avatar;
                createSocialButtons(foundHost);
                hostResult.style.display = 'block';
            } else {
                console.log('No host found for:', searchTerm);
                noResult.style.display = 'block';
            }
        }

        function showAddHostForm() {
            document.getElementById('addHostForm').style.display = 'block';
            document.getElementById('hostResult').style.display = 'none';
            document.getElementById('noResult').style.display = 'none';
            hideSuccessMessage();
            // Reset uploaded image
            removePhoto();
        }
        
        function hideAddHostForm() {
            document.getElementById('addHostForm').style.display = 'none';
            document.getElementById('newHostName').value = '';
            document.getElementById('newHostBigoId').value = '';
            document.getElementById('newHostFacebook').value = '';
            document.getElementById('newHostInstagram').value = '';
            document.getElementById('newHostTiktok').value = '';
            document.getElementById('newHostTelegram').value = '';
            document.getElementById('newHostYoutube').value = '';
            // Reset uploaded image
            removePhoto();
        }

        function showSuccessMessage() {
            document.getElementById('successMessage').style.display = 'block';
            setTimeout(hideSuccessMessage, 5000);
        }

        function hideSuccessMessage() {
            document.getElementById('successMessage').style.display = 'none';
        }

        function showLoading(message) {
            document.getElementById('loading').textContent = message;
            document.getElementById('loading').style.display = 'block';
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }

        async function submitNewHost() {
            const name = document.getElementById('newHostName').value.trim();
            const bigoId = document.getElementById('newHostBigoId').value.trim();
            const facebook = document.getElementById('newHostFacebook').value.trim();
            const instagram = document.getElementById('newHostInstagram').value.trim();
            const tiktok = document.getElementById('newHostTiktok').value.trim();
            const telegram = document.getElementById('newHostTelegram').value.trim();
            const youtube = document.getElementById('newHostYoutube').value.trim();
            
            if (!name || !bigoId) {
                alert('á€€á€»á€±á€¸á€‡á€°á€¸á€•á€¼á€¯á á€¡á€™á€Šá€ºá€”á€¾á€„á€·á€º BIGO ID á€€á€­á€¯á€–á€¼á€Šá€·á€ºá€•á€«');
                return;
            }
            
            try {
                showLoading('á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸ á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€”á€±á€•á€«á€á€Šá€º...');
                
                // For now, we'll use a default avatar since we can't upload to Google Sheets directly
                // In a real app, you'd need to upload to a image hosting service first
                let avatarUrl = getDefaultAvatar();
                
                if (uploadedAvatar) {
                    // In a real implementation, you would:
                    // 1. Upload the image to a service like ImgBB, Cloudinary, etc.
                    // 2. Get the URL and use it here
                    // For now, we'll use the default avatar and show a message
                    alert('ğŸ“¸ á€“á€¬á€á€ºá€•á€¯á€¶á€¡á€á€½á€€á€º á€€á€»á€±á€¸á€‡á€°á€¸á€á€„á€ºá€•á€«á€á€šá€º! á€œá€±á€¬á€œá€±á€¬á€†á€šá€º default profile picture á€á€¯á€¶á€¸á€‘á€¬á€¸á€•á€«á€á€šá€ºá‹');
                }
                
                const formData = new URLSearchParams();
                formData.append('action', 'addData');
                formData.append('name', name);
                formData.append('bigo_id', bigoId);
                formData.append('facebook', facebook || 'none');
                formData.append('instagram', instagram || 'none');
                formData.append('tiktok', tiktok || 'none');
                formData.append('telegram', telegram || 'none');
                formData.append('youtube', youtube || 'none');
                formData.append('avatar', avatarUrl);
                
                console.log('Sending data to Google Sheets...');
                
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                console.log('Google Sheets Response:', result);
                
                if (result.status === 'success') {
                    // Immediately add to local hosts object
                    hosts[bigoId] = {
                        name: name,
                        bigoId: bigoId,
                        facebook: facebook || 'none',
                        instagram: instagram || 'none',
                        tiktok: tiktok || 'none',
                        telegram: telegram || 'none',
                        youtube: youtube || 'none',
                        avatar: avatarUrl
                    };
                    
                    console.log('Added to local hosts:', hosts[bigoId]);
                    
                    showSuccessMessage();
                    hideAddHostForm();
                    
                    // Auto-search for the new host
                    document.getElementById('searchInput').value = bigoId;
                    setTimeout(() => {
                        searchHost();
                    }, 1000);
                    
                } else {
                    throw new Error(result.data);
                }
            } catch (error) {
                console.error('Error:', error);
                const confirmSave = confirm(
                    'á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸ á€á€®á€™á€ºá€¸á€•á€¼á€®á€¸á€•á€«á‹\n\n' +
                    'á€’á€® ID á€€á€­á€¯ á€á€»á€€á€ºá€á€»á€„á€ºá€¸á€›á€¾á€¬á€€á€¼á€Šá€·á€ºá€™á€œá€¬á€¸?\n\n' +
                    'BIGO ID: ' + bigoId
                );
                
                if (confirmSave) {
                    // Add to local hosts anyway
                    hosts[bigoId] = {
                        name: name,
                        bigoId: bigoId,
                        facebook: facebook || 'none',
                        instagram: instagram || 'none',
                        tiktok: tiktok || 'none',
                        telegram: telegram || 'none',
                        youtube: youtube || 'none',
                        avatar: getDefaultAvatar()
                    };
                    
                    hideAddHostForm();
                    document.getElementById('searchInput').value = bigoId;
                    setTimeout(() => searchHost(), 500);
                }
            } finally {
                hideLoading();
            }
        }

        // Event Listeners
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') searchHost();
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', initTelegram);
    </script>
</body>
</html>
